{"version":3,"sources":["../../../src/components/static-map.js"],"names":["PureComponent","createElement","createRef","PropTypes","normalizeStyle","WebMercatorViewport","AutoSizer","Mapbox","mapboxgl","checkVisibilityConstraints","MAPBOX_LIMITS","MapContext","TOKEN_DOC_URL","NO_TOKEN_WARNING","noop","UNAUTHORIZED_ERROR_CODE","CONTAINER_STYLE","position","width","height","overflow","propTypes","Object","assign","oneOfType","number","string","onResize","func","preventStyleDiffing","bool","disableTokenWarning","visible","className","style","object","visibilityConstraints","defaultProps","updateMapStyle","StaticMap","accessTokenInvalid","_map","geometry","options","queryRenderedFeatures","evt","statusCode","error","status","state","console","setState","props","onError","supported","mapStyle","_mapbox","_width","_height","container","_mapboxMapRef","current","_mapboxMapError","getMap","prevProps","_updateMapStyle","_updateMapProps","finalize","oldProps","newProps","oldMapStyle","setStyle","diff","setProps","left","top","key","id","href","dimensions","Number","_updateMapSize","Consumer","interactiveContext","context","viewport","viewState","map","mapContainer","_mapContainerRef","Provider","value","children","mapContainerStyle","visibility","ref","disableWidth","isFinite","disableHeight","_renderOverlays","bind","_renderNoTokenWarning"],"mappings":"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","sourcesContent":["// @flow\n// Copyright (c) 2015 Uber Technologies, Inc.\n\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\nimport {PureComponent, createElement, createRef} from 'react';\nimport PropTypes from 'prop-types';\n\nimport {normalizeStyle} from '../utils/style-utils';\n\nimport WebMercatorViewport from 'viewport-mercator-project';\nimport AutoSizer from 'react-virtualized-auto-sizer';\n\nimport Mapbox from '../mapbox/mapbox';\nimport mapboxgl from '../utils/mapboxgl';\nimport {checkVisibilityConstraints} from '../utils/map-constraints';\nimport {MAPBOX_LIMITS} from '../utils/map-state';\nimport MapContext from './map-context';\n\nimport type {ViewState} from '../mapbox/mapbox';\n\n/* eslint-disable max-len */\nconst TOKEN_DOC_URL =\n  'https://uber.github.io/react-map-gl/#/Documentation/getting-started/about-mapbox-tokens';\nconst NO_TOKEN_WARNING = 'A valid API access token is required to use Mapbox data';\n/* eslint-disable max-len */\n\nfunction noop() {}\n\nconst UNAUTHORIZED_ERROR_CODE = 401;\n\nconst CONTAINER_STYLE = {\n  position: 'absolute',\n  width: '100%',\n  height: '100%',\n  overflow: 'hidden'\n};\n\nconst propTypes = Object.assign({}, Mapbox.propTypes, {\n  /** The dimensions of the map **/\n  width: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  height: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n\n  /** Callback when map size changes **/\n  onResize: PropTypes.func,\n  /** There are known issues with style diffing. As stopgap, add option to prevent style diffing. */\n  preventStyleDiffing: PropTypes.bool,\n  /** Hide invalid token warning even if request fails */\n  disableTokenWarning: PropTypes.bool,\n  /** Whether the map is visible */\n  visible: PropTypes.bool,\n  /** Custom class name for the map */\n  className: PropTypes.string,\n  /** Custom CSS for the container */\n  style: PropTypes.object,\n\n  /** Advanced features */\n  // Contraints for displaying the map. If not met, then the map is hidden.\n  // Experimental! May be changed in minor version updates.\n  visibilityConstraints: PropTypes.object\n});\n\nconst defaultProps = Object.assign({}, Mapbox.defaultProps, {\n  preventStyleDiffing: false,\n  disableTokenWarning: false,\n  updateMapStyle: true,\n  visible: true,\n  onResize: noop,\n  className: '',\n  style: null,\n  visibilityConstraints: MAPBOX_LIMITS\n});\n\nexport type StaticMapProps = {\n  gl?: any,\n  width: number | string,\n  height: number | string,\n  preventStyleDiffing: boolean,\n  disableTokenWarning: boolean,\n  visible: boolean,\n  className: string,\n  style: any,\n  visibilityConstraints: any,\n  children?: any,\n  onLoad: Function,\n  onError: Function,\n  onResize: Function,\n  mapStyle: any,\n  visible: boolean,\n  viewState?: ViewState,\n  longitude: number,\n  latitude: number,\n  zoom: number,\n  bearing: number,\n  pitch: number,\n  altitude?: number,\n  updateMapStyle: Boolean\n};\n\ntype State = {\n  accessTokenInvalid: boolean\n};\n\nexport default class StaticMap extends PureComponent<StaticMapProps, State> {\n  static supported() {\n    return mapboxgl && mapboxgl.supported();\n  }\n\n  static propTypes: any = propTypes;\n  static defaultProps: StaticMapProps = defaultProps;\n\n  state: State = {\n    accessTokenInvalid: false\n  };\n\n  componentDidMount() {\n    if (!StaticMap.supported()) {\n      return;\n    }\n    const {mapStyle} = this.props;\n\n    this._mapbox = new Mapbox(\n      // $FlowFixMe\n      Object.assign({}, this.props, {\n        mapboxgl, // Handle to mapbox-gl library\n        width: this._width,\n        height: this._height,\n        container: this._mapboxMapRef.current,\n        onError: this._mapboxMapError,\n        mapStyle: normalizeStyle(mapStyle)\n      })\n    );\n    this._map = this._mapbox.getMap();\n  }\n\n  componentDidUpdate(prevProps: StaticMapProps) {\n    if (this._mapbox) {\n      this._updateMapStyle(prevProps, this.props);\n      this._updateMapProps(this.props);\n    }\n  }\n\n  componentWillUnmount() {\n    if (this._mapbox) {\n      this._mapbox.finalize();\n      this._mapbox = null;\n      this._map = null;\n    }\n  }\n\n  _mapbox: any = null;\n  _map: any = null;\n  _mapboxMapRef: {current: null | HTMLDivElement} = createRef();\n  _mapContainerRef: {current: null | HTMLDivElement} = createRef();\n  _queryParams: any = {};\n  _width: number = 0;\n  _height: number = 0;\n\n  // External apps can access map this way\n  getMap = () => {\n    return this._map;\n  };\n\n  /** Uses Mapbox's\n   * queryRenderedFeatures API to find features at point or in a bounding box.\n   * https://www.mapbox.com/mapbox-gl-js/api/#Map#queryRenderedFeatures\n   * To query only some of the layers, set the `interactive` property in the\n   * layer style to `true`.\n   * @param {[Number, Number]|[[Number, Number], [Number, Number]]} geometry -\n   *   Point or an array of two points defining the bounding box\n   * @param {Object} options - query options\n   */\n  queryRenderedFeatures = (geometry: any, options: any = {}) => {\n    return this._map.queryRenderedFeatures(geometry, options);\n  };\n\n  // Note: needs to be called after render (e.g. in componentDidUpdate)\n  _updateMapSize(width: number, height: number) {\n    if (this._width !== width || this._height !== height) {\n      this._width = width;\n      this._height = height;\n      this._updateMapProps(this.props);\n    }\n  }\n\n  _updateMapStyle(oldProps: StaticMapProps, newProps: StaticMapProps) {\n    const mapStyle = newProps.mapStyle;\n    const oldMapStyle = oldProps.mapStyle;\n    if (newProps.updateMapStyle && (mapStyle !== oldMapStyle || !oldProps.updateMapStyle)) {\n      this._map.setStyle(normalizeStyle(mapStyle), {\n        diff: !this.props.preventStyleDiffing\n      });\n    }\n  }\n\n  _updateMapProps(props: StaticMapProps) {\n    if (!this._mapbox) {\n      return;\n    }\n    this._mapbox.setProps(\n      Object.assign({}, props, {\n        width: this._width,\n        height: this._height\n      })\n    );\n  }\n\n  // Handle map error\n  _mapboxMapError = (evt: {\n    error?: {\n      message: string,\n      status: number\n    },\n    status: number\n  }) => {\n    const statusCode = (evt.error && evt.error.status) || evt.status;\n    if (statusCode === UNAUTHORIZED_ERROR_CODE && !this.state.accessTokenInvalid) {\n      // Mapbox throws unauthorized error - invalid token\n      console.error(NO_TOKEN_WARNING); // eslint-disable-line\n      this.setState({accessTokenInvalid: true});\n    }\n    this.props.onError(evt);\n  };\n\n  _renderNoTokenWarning() {\n    if (this.state.accessTokenInvalid && !this.props.disableTokenWarning) {\n      const style = {\n        position: 'absolute',\n        left: 0,\n        top: 0\n      };\n      return createElement('div', {key: 'warning', id: 'no-token-warning', style}, [\n        createElement('h3', {key: 'header'}, NO_TOKEN_WARNING),\n        createElement('div', {key: 'text'}, 'For information on setting up your basemap, read'),\n        createElement('a', {key: 'link', href: TOKEN_DOC_URL}, 'Note on Map Tokens')\n      ]);\n    }\n\n    return null;\n  }\n\n  _renderOverlays(dimensions: {width?: number, height?: number}) {\n    const {width = Number(this.props.width), height = Number(this.props.height)} = dimensions;\n    this._updateMapSize(width, height);\n\n    return createElement(MapContext.Consumer, null, interactiveContext => {\n      const context = Object.assign({}, interactiveContext, {\n        viewport: new WebMercatorViewport(\n          // $FlowFixMe\n          Object.assign({}, this.props, this.props.viewState, {\n            width,\n            height\n          })\n        ),\n        map: this._map,\n        mapContainer: interactiveContext.mapContainer || this._mapContainerRef.current\n      });\n\n      return createElement(\n        MapContext.Provider,\n        {value: context},\n        createElement('div', {\n          key: 'map-overlays',\n          className: 'overlays',\n          style: CONTAINER_STYLE,\n          children: this.props.children\n        })\n      );\n    });\n  }\n\n  render() {\n    const {className, width, height, style, visibilityConstraints} = this.props;\n    const mapContainerStyle = Object.assign({position: 'relative'}, style, {\n      width,\n      height\n    });\n\n    const visible =\n      this.props.visible &&\n      checkVisibilityConstraints(this.props.viewState || this.props, visibilityConstraints);\n\n    const mapStyle = Object.assign({}, CONTAINER_STYLE, {\n      visibility: visible ? 'inherit' : 'hidden'\n    });\n\n    return createElement('div', {\n      key: 'map-container',\n      style: mapContainerStyle,\n      ref: this._mapContainerRef,\n      children: [\n        createElement('div', {\n          key: 'map-mapbox',\n          ref: this._mapboxMapRef,\n          style: mapStyle,\n          className\n        }),\n        // AutoSizer is a pure component and does not rerender when map props change\n        // rebind the callback so that it's triggered every render pass\n        createElement(\n          AutoSizer,\n          {\n            key: 'autosizer',\n            disableWidth: Number.isFinite(width),\n            disableHeight: Number.isFinite(height),\n            onResize: this.props.onResize\n          },\n          this._renderOverlays.bind(this)\n        ),\n        this._renderNoTokenWarning()\n      ]\n    });\n  }\n}\n"],"file":"static-map.js"}